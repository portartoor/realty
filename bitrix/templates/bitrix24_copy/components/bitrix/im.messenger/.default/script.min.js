BX.ready(function(){BX.isImBarTransparent=false;BX.bind(window,"scroll",bxImBarRedraw);BX.bind(window,"resize",bxImBarRedraw);BX.addCustomEvent("onTopPanelCollapse",bxImBarRedraw);bxImBarRedraw();BX.bind(BX("bx-im-bar-notify"),"click",function(){if(typeof BXIM=="undefined")return false;BX.desktopUtils.runningCheck(function(){BX.desktopUtils.goToBx("bx://notify")},function(){BXIM.openNotify()},true)});BX.bind(BX("bx-im-online-count-btn"),"click",function(){if(typeof BXIM=="undefined")return false;BX.desktopUtils.runningCheck(function(){BX.desktopUtils.goToBx("bx://messenger")},function(){BXIM.toggleMessenger()},true)});BX.bind(BX("bx-im-bar-add"),"click",function(){if(typeof BXIM=="undefined")return false;BX.desktopUtils.runningCheck(function(){BXIM.messenger.openPopupMenu(BX("bx-im-bar-add"),"createChat",null,{offsetTop:-44,offsetLeft:-160,anglePosition:"right",openDesktop:true})},function(){BXIM.messenger.openPopupMenu(BX("bx-im-bar-add"),"createChat",null,{offsetTop:-44,offsetLeft:-160,anglePosition:"right",openMessenger:true})},true)});BX.bind(BX("bx-im-bar-search"),"click",function(){if(typeof BXIM=="undefined")return false;BX.desktopUtils.runningCheck(function(){BX.desktopUtils.goToBx("bx://messenger/dialog/0")},function(){BXIM.openMessenger(0)},true)});BX.bind(BX("bx-im-btn-call"),"click",function(e){if(typeof BXIM=="undefined")return false;BXIM.webrtc.openKeyPad(e)});BX.bind(window,"scroll",function(){if(typeof BXIM=="undefined"||!BXIM.messenger.popupPopupMenu)return true;if(BX.util.in_array(BXIM.messenger.popupPopupMenu.uniquePopupId.replace("bx-messenger-popup-",""),["createChat","contactList"])){BXIM.messenger.popupPopupMenu.close()}});BX.bindDelegate(BX("bx-im-external-recent-list"),"contextmenu",{className:"bx-messenger-cl-item"},function(e){if(typeof BXIM=="undefined")return false;var n=this;BX.desktopUtils.runningCheck(function(){BX.desktopUtils.goToBx("bx://messenger/dialog/"+n.getAttribute("data-userId"))},function(){BXIM.messenger.openPopupMenu(n,"contactList",false)},true);return BX.PreventDefault(e)});BX.bindDelegate(BX("bx-im-external-recent-list"),"click",{className:"bx-messenger-cl-item"},function(e){if(typeof BXIM=="undefined")return false;var n=this;BX.desktopUtils.runningCheck(function(){BX.desktopUtils.goToBx("bx://messenger/dialog/"+n.getAttribute("data-userId"))},function(){BXIM.openMessenger(n.getAttribute("data-userId"))},true)});BX.addCustomEvent("onImUpdateCounterNotify",function(e){var n=BX.findChildByClassName(BX("bx-im-bar-notify"),"bx-im-informer-num");if(!n)return false;if(e>0){n.innerHTML='<div class="bx-im-informer-num-digit">'+(e>99?"99+":e)+"</div>"}else{n.innerHTML=""}});BX.addCustomEvent("onPullOnlineEvent",BX.delegate(function(e,n){if(e=="user_online"){if(typeof BXIM.messenger.online=="undefined")return false;if(BXIM.messenger.online[n.USER_ID]!="Y"){BXIM.messenger.online[n.USER_ID]="Y";bxImBarRecount()}}else if(e=="user_offline"){if(typeof BXIM.messenger.online=="undefined")return false;if(BXIM.messenger.online[n.USER_ID]=="Y"){BXIM.messenger.online[n.USER_ID]="N";bxImBarRecount()}}else if(e=="online_list"){BXIM.messenger.online={};for(var t in n.USERS){BXIM.messenger.online[t]="Y"}bxImBarRecount()}},this));BX.addCustomEvent("onImInit",function(e){e.notify.panelButtonCall=BX("bx-im-btn-call");e.notify.panelButtonCallOffsetTop=-100;e.notify.panelButtonCallOffsetLeft=-240;e.notify.panelButtonCallAnlgePosition="right";e.notify.panelButtonCallAnlgeOffset=221;BX.MessengerCommon.recentListRedraw()})});function bxImBarRecount(){if(typeof BXIM.messenger.online=="undefined")return false;var e=0;for(var n in BXIM.messenger.online){if(BXIM.messenger.online[n]=="Y"){e++}}e=e<=0?1:e;e=e>9999?9999:e;BX("bx-im-online-count").innerHTML=e;return true}
//# sourceMappingURL=script.map.js