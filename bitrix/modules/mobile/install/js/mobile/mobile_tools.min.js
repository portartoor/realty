(function(e){if(e.BX.MobileTools)return;BX.MobileTools={phoneTo:function(e,o){o=typeof o=="object"?o:{};BXMobileApp.onCustomEvent("onPhoneTo",{number:e,params:o},true)},callTo:function(e,o){o=typeof o=="undefined"?false:o;BXMobileApp.onCustomEvent("onCallInvite",{userId:e,video:o},true)},getMobileUrlParams:function(e){var o=[{exp:/\/company\/personal\/user\/(\d+)\/calendar\/\?EVENT_ID=(\d+).*/gi,replace:"/mobile/calendar/view_event.php?event_id=$2",useNewStyle:false},{exp:/\/company\/personal\/user\/(\d+)\/tasks\/task\/view\/(\d+)\//gi,replace:"/mobile/tasks/snmrouter/?routePage=view&USER_ID=$1&GROUP_ID=0&TASK_ID=$2",useNewStyle:true},{exp:/\/workgroups\/group\/(\d+)\/tasks\/task\/view\/(\d+)\//gi,replace:"/mobile/tasks/snmrouter/?routePage=view&GROUP_ID=$1&TASK_ID=$2",useNewStyle:true},{exp:/\/company\/personal\/user\/(\d+)\/blog\/(\d+)\/\?commentId=(\d+)#com(\d+)/gi,replace:"/mobile/log/?ACTION=CONVERT&ENTITY_TYPE_ID=BLOG_POST&ENTITY_ID=$2&commentId=$3#com$4",useNewStyle:true},{exp:/\/company\/personal\/user\/(\d+)\/blog\/(\d+)\//gi,replace:"/mobile/log/?ACTION=CONVERT&ENTITY_TYPE_ID=BLOG_POST&ENTITY_ID=$2",useNewStyle:true},{exp:/\/company\/personal\/log\/(\d+)\//gi,replace:"/mobile/log/?ACTION=CONVERT&ENTITY_TYPE_ID=LOG_ENTRY&ENTITY_ID=$1",useNewStyle:true},{exp:/\/company\/personal\/user\/(\d+)\//gi,replace:"/mobile/users/?user_id=$1",useNewStyle:true},{exp:/\/crm\/(deal|lead|company|contact)\/show\/(\d+)\//gi,replace:"/mobile/crm/$1/?page=view&$1_id=$2",useNewStyle:true}];var r=null;for(var t=0;t<o.length;t++){var i=e.replace(o[t].exp,o[t].replace);if(i!=e){r={url:i,bx24ModernStyle:o[t].useNewStyle};break}}return r},createCardScanner:function(e){return new function o(){this.onError=function(e){console.error("Error",e)};this.stripEmptyFields=e.stripEmptyFields||false;this.options=e;this.imageData=null;if(e["onResult"]){this.onResult=e["onResult"]}if(e["onError"]){this.onError=e["onError"]}if(e["onImageGet"]){this.onImageGet=e["onImageGet"]}this.open=function(){app.exec("openBusinessCardScanner",{callback:BX.proxy(function(e){if(e.canceled!=1&&e.url.length>0){this.imageData=e;if(this.options["onImageGet"]){this.onImageGet(e)}this.send()}},this)})};this.send=function(){if(this.options.url){var e=new FileUploadOptions;e.fileKey="card_file";e.fileName="image.jpg";e.mimeType="image/jpeg";e.chunkedMode=false;e.params={image:"Y"};var o=new FileTransfer;o.upload(this.imageData.url,this.options.url,BX.proxy(function(e){try{var o=JSON.parse(e.response);this.UNIQUE_ID=o.UNIQUE_ID;if(o.STATUS!="success"){if(o.ERROR){this.onError(o.ERROR)}return}else{this.options["onImageUploaded"](o)}BX.addCustomEvent("onPull-bizcard",this.handler)}catch(r){this.onError(r)}},this),BX.proxy(function(e){this.onError({code:e.code,message:"Can't upload image"})},this),e)}};this.handler=BX.proxy(function(e){var o=e.params.RESULT;if(!o.ERROR&&o.UNIQUE_ID==this.UNIQUE_ID){BX.removeCustomEvent("onPull-bizcard",this.handler);if(typeof this.onResult=="function"){var r=o.DATA;var t={DATA:{},CARD_ID:o.CARD_ID};if(typeof r=="object"){if(this.stripEmptyFields){var i={};for(var n in r){if(r[n]!="")i[n]=r[n]}t.DATA=i}else{t.DATA=r}this.onResult(t)}else{this.onError(o)}}}},this)}}}})(window);
//# sourceMappingURL=mobile_tools.map.js